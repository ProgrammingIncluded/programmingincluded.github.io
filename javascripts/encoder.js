function blocks(r){for(var e=[],o=0;o<r.length/16;++o)e.push(r.slice(16*o,16*(o+1)));return e}function hexblock(r){for(var e=blocks(r.split("")),o=[],n=0;n<e.length;++n){for(var t=e[n],h=[],c=0;c<t.length;++c){var s=Number(t[c].charCodeAt(0));h.push(s)}o.push(h)}return o}function dehexblock(r){for(var e="",o=0;o<r.length;++o)for(var n=0;n<r[o].length;++n)e+=String.fromCharCode(r[o][n]);return e}function decode(r,e){var o,n=sjcl.hash.sha256,t=sjcl.codec.bytes,n=n.hash(r);t.fromBits(n);e=JSON.parse(e),AES_Init(),o=t.fromBits(n),AES_ExpandKey(o);for(var h=0;h<e.length;++h)AES_Decrypt(e[h],o);r=dehexblock(e);return AES_Done(),r}