function blocks(r){for(var e=[],o=0;o<r.length/16;++o)e.push(r.slice(16*o,16*(o+1)));return e}function hexblock(r){for(var e=blocks(r.split("")),o=[],n=0;n<e.length;++n){for(var t=e[n],h=[],c=0;c<t.length;++c){var a=Number(t[c].charCodeAt(0));h.push(a)}o.push(h)}return o}function dehexblock(r){for(var e="",o=0;o<r.length;++o)for(var n=0;n<r[o].length;++n)e+=String.fromCharCode(r[o][n]);return e}function decode(r,e){var o=sjcl.hash.sha256,n=sjcl.codec.bytes,t=o.hash(r),h=n.fromBits(t);e=JSON.parse(e),AES_Init(),h=n.fromBits(t),AES_ExpandKey(h);for(var c=0;c<e.length;++c)AES_Decrypt(e[c],h);var a=dehexblock(e);return AES_Done(),a}